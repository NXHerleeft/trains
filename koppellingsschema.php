<!doctype html>
<html>
<head>
    <title>Koppelingsschema</title>
    <style type="text/css">
        * {
            padding: 0;
            margin: 0;
        }

        html {
            font-family: arial;
        }

        table.schema {
            border-spacing: 0;
            border-collapse: collapse;
        }

        table.schema tr.datarow td {
            height: 25px;
        }

        table.schema tr td {
            padding: 2px;
            margin: 0px;
            border-spacing: 0;
            border: 2px solid #000000;
        }

        table.schema tr td.vertical {
            vertical-align: bottom;
        }

        table.schema tr td.short {
            width: 25px;
        }

        table.schema tr td.spacer {
            border: none;
        }

        table.schema tr.center {
            text-align: center;
        }

        table.schema tr td.center {
            text-align: center;
        }

        table.schema tr td.stripes-vertical {
            background: url(stripes-vertical.png);
            background-size: cover;
        }

        table.schema tr td.stripes-diagonal-1 {
            background: url(stripes-diagonal-1.png);
            background-size: cover;
        }

        table.schema tr td.stripes-diagonal-2 {
            background: url(stripes-diagonal-2.png);
            background-size: cover;
        }
    </style>
</head>
<body>
<table class="schema">
    <tr class="center">
        <td class="short vertical">22</td>
        <td class="short vertical">GR<br />22</td>
        <td class="short vertical">GR<br />2</td>
        <td class="short vertical">2</td>
        <td class="short vertical">H5 / st. 5</td>
    </tr>
    <tr class="center">
        <td class="short">11</td>
        <td class="short">13</td>
        <td class="short">17</td>
        <td class="short">18</td>
        <td class="short">20</td>
        <td class="spacer">&nbsp;</td>
        <td>SEIN</td>
        <td class="short">KR</td>
        <td class="short">1</td>
        <td class="short">2</td>
        <td class="short">3</td>
        <td class="short">4</td>
        <td class="short">6</td>
        <td class="short">7</td>
        <td class="short">12</td>
    </tr>
    <tr class="datarow">
        <td class="center input-fields" data-contents="">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Sein D<sub>2</sub>/D<sup>v</sup></td>
        <td>D<sub>2</sub>/D<sup>v</sup></td>
        <td class="center">1</td>
        <td class="center input-coupling" data-contents="1">&nbsp;</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center">&larr;</td>
    </tr>
    <tr class="datarow">
        <td>&nbsp;</td>
        <td class="center">&#x2A2B;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Naar Spv v. sp. 1</td>
        <td>C<sub>1,2</sub></td>
        <td class="center">2</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center">2</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
    </tr>
    <tr class="datarow">
        <td class="center">+</td>
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td>Naar Spv v. sp. 2</td>
        <td>C<sub>1,2</sub></td>
        <td class="center">3</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center">3</td>
        <td class="center">&nbsp;</td>
        <td class="center">=</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
    </tr>
    <tr class="datarow">
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center">+</td>
        <td class="center">&#9911;</td>
        <td>Naar Krd v. sp. 2</td>
        <td>B<sub>2</sub></td>
        <td class="center">4</td>
        <td class="center">&#8853;</td>
        <td class="center">&#8854;</td>
        <td class="center">&nbsp;</td>
        <td class="center">4</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center">=</td>
    </tr>
    <tr class="datarow">
        <td class="center">+</td>
        <td class="center">&nbsp;</td>
        <td class="center">&#x2A2B;</td>
        <td class="center">+</td>
        <td class="center">&#9911;</td>
        <td>Van Krd op sp. 2</td>
        <td>A<sub>1,2</sub>/A<sup>v</sup></td>
        <td class="center">6</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center">=</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
        <td class="center">6</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
    </tr>
    <tr class="datarow">
        <td class="center">&#x2A2B;</td>
        <td class="center">&nbsp;</td>
        <td class="center">&#x2A2B;</td>
        <td class="center">&#x2A2B;</td>
        <td class="center">&#9911;</td>
        <td>Van Krd op sp. 1</td>
        <td>A<sub>1,2</sub>/A<sup>v</sup></td>
        <td class="center">7</td>
        <td class="center stripes-vertical">&nbsp;</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center">7</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
    </tr>
    <tr class="datarow">
        <td class="center">+</td>
        <td class="center">&#x2A2B;</td>
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td class="center">&nbsp;</td>
        <td>Van Spv op sp. 2</td>
        <td></td>
        <td class="center">12</td>
        <td class="center">&uarr;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
        <td class="center">=</td>
        <td class="center stripes-diagonal-2">&nbsp;</td>
        <td class="center stripes-diagonal-1">&nbsp;</td>
        <td class="center">12</td>
    </tr>
</table>
<button type="button" id="add-row">+ row</button>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script>
    var i = 0;
    $('.input-coupling').click(function() {
        console.log('clicked');
        $(this).removeClass('stripes-vertical').removeClass('stripes-diagonal-1').removeClass('stripes-diagonal-2');

        $(this).html('<input id="input-' + i + '" type="text" maxlength="2" style="width: 23px;" value="' + $(this).attr('data-contents') + '" />');

        $('input#input-' + i).focus();
        $('input#input-' + i).blur(function() {
            console.log($(this).val());
            var cell = $(this).parent();
            cell.attr('data-contents', $(this).val());
            cell.html('');


            switch(cell.attr('data-contents')) {
                case '|':
                    cell.addClass('stripes-vertical');
                    break;
                case '/':
                    cell.addClass('stripes-diagonal-1');
                    break;
                case '\\':
                    cell.addClass('stripes-diagonal-2');
                    break;
                case '<':
                    cell.html('&larr;');
                    break;
                case '>':
                    cell.html('&rarr;');
                    break;
                case '^':
                    cell.html('&uarr;');
                    break;
                case 'v':
                case 'V':
                    cell.html('&darr;');
                    break;
                default:
                    cell.html(cell.attr('data-contents'));
            }
        });

        i ++;
    });

    $('.input-fields').click(function() {
        $(this).html('<input id="input-' + i + '" type="text" maxlength="2" style="width: 23px;" value="' + $(this).attr('data-contents') + '" />');

        $('input#input-' + i).focus();
        $('input#input-' + i).blur(function() {

            var cell = $(this).parent();
            cell.attr('data-contents', $(this).val());
            cell.html('');


            switch(cell.attr('data-contents')) {
                case '+':
                    cell.html('+');
                    break;
                case '-':
                    cell.html('&#x2A2B;');
                    break;
                case 'O+':
                    cell.html('&#8853;');
                    break;
                case 'O-':
                    cell.html('&#8854;');
                    break;
                case 'k':
                case 'K':
                    cell.html('&#9911;');
                    break;
                default:
                    cell.html(cell.attr('data-contents'));
            }
        });

        i ++;
    });

    $('#add-row').click(function() {
        $('.schema').append('<tr class="datarow"><td class="center">&nbsp;</td><td class="center">&nbsp;</td><td class="center">&nbsp;</td><td class="center">&nbsp;</td><td class="center">&nbsp;</td><td>&nbsp;</td><td><input type="text" name="signal[]" size="5" /></td><td class="center"><input type="text" name="field[]" style="width: 90%;" /></td><td class="center">&uarr;</td> <td class="center stripes-diagonal-1">&nbsp;</td> <td class="center stripes-diagonal-2">&nbsp;</td> <td class="center">&nbsp;</td><td class="center stripes-diagonal-2">&nbsp;</td><td class="center stripes-diagonal-1">&nbsp;</td><td class="center">&nbsp;</td></tr>')
    });
</script>
</body>
</html>